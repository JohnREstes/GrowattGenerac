<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ESP8266 Control Panel</title>
    <link rel="stylesheet" href="/espcontrol/styles.css">
</head>
<body>
    <h1>ESP8266 GPIO Control TEST</h1>

    <button onclick="location.href='/espcontrol/logout'" style="float: right; margin-top: -40px;">ðŸšª Logout</button>

    <label>
        <input type="checkbox" class="toggle" id="pinToggle" onchange="togglePin()">
    </label>
    <div id="status">Loading...</div>

    <div id="schedule">
        <h2>Schedule Settings</h2>

        <label for="deviceSelect">Select Device:</label>
        <select id="deviceSelect" onchange="loadSchedule()">
            <option value="">-- Choose Device --</option>
        </select>

        <label for="timezone">Timezone:</label>
        <select id="timezone">
            <option value="UTC">UTC</option>
            <option value="America/New_York">America/New_York</option>
            <option value="America/Cancun">America/Cancun</option>
            <option value="America/Chicago">America/Chicago</option>
            <option value="America/Los_Angeles">America/Los_Angeles</option>
        </select>

        <div id="events"></div>

        <button onclick="addEvent()">+ Add Event</button>
        <button onclick="saveSchedule()">ðŸ’¾ Save Schedule</button>

        <div id="saveStatus" style="margin-top: 10px;"></div>
    </div>

    <div class="section">
        <h2>Integrations</h2>
        <div class="integration-form-container">
            <h3>Add New Growatt Integration</h3>
            <form id="addGrowattIntegrationForm">
                <label for="growattIntegrationName">Integration Name:</label>
                <input type="text" id="growattIntegrationName" name="name" required><br><br>

                <label for="growattUsername">Growatt Username:</label>
                <input type="text" id="growattUsername" name="username" required><br><br>

                <label for="growattPassword">Growatt Password:</label>
                <input type="password" id="growattPassword" name="password" required><br><br>

                <label for="growattServer">Growatt Server URL:</label>
                <input type="text" id="growattServer" name="server" value="https://server-us.growatt.com/" required><br><br>

                <label for="growattPlantId">Growatt Plant ID:</label>
                <input type="text" id="growattPlantId" name="plantId" placeholder="e.g., 4466"><br><br>

                <label for="growattDeviceSerials">Device Serial Numbers (comma-separated):</label>
                <input type="text" id="growattDeviceSerials" name="deviceSerialNumbers" placeholder="e.g., UKDFBHG0GX,XSK0CKS058"><br><br>

                <button type="submit">Add Growatt Integration</button>
            </form>
        </div>

        <section id="growattSection">
          <h3>Link Growatt Account</h3>
          <input type="email" id="growattEmail" placeholder="Growatt Email">
          <input type="password" id="growattPassword" placeholder="Growatt Password">
          <button onclick="loginGrowatt()">Login</button>

          <div id="inverterList"></div>
        </section>


        <div class="existing-integrations">
            <h3>Your Existing Integrations</h3>
            <ul id="integrationList">
                <li>Loading integrations...</li>
            </ul>
            </div>
    </div>
    <script src="/espcontrol/script.js"></script>
</body>
</html>